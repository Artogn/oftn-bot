var utils={pretty_print:function(b,c){if(typeof c==="undefined")c=5;else if(!c)return"\u2026";if(b===null)return"null";var d=[];return function(a,g){switch(typeof a){case "string":return utils.string_format(a);case "number":case "boolean":return a.toString();case "function":if(a.name&&a.name!=="anonymous")return"(function) "+a.name;var e=Object.prototype.toString.call(a);if(e==="[object RegExp]")return RegExp.prototype.toString.call(a);var f;f=Function.prototype.toString.call(a).replace(/\s+/g," ");
return f.length>48?f.substr(0,46)+"\u2026}":f;case "object":if(Array.isArray(a)){if(~d.indexOf(a))return"(Circular)";d.push(a);e=[];f=0;for(var h=a.length;f<h;f++)e.push(arguments.callee(a[f],g-1));d.pop();return"["+e.join(", ")+"]"}else{e=Object.prototype.toString.call(a);e=e.substring(8,e.length-1);switch(e){case "Date":return"(object) "+Date.prototype.toString.call(a);case "Boolean":return"(object) "+Boolean.prototype.toString.call(a);case "Number":return"(object) "+Number.prototype.toString.call(a);
case "String":return"(object) "+this.string_format(String.prototype.toString.call(a))}if(~d.indexOf(a))return"(Circular)";d.push(a);e=[];for(f in a)Object.prototype.hasOwnProperty.call(a,f)&&e.push(f+": "+arguments.callee(a[f],g-1));d.pop();return"{"+e.join(", ")+"}"}case "undefined":return"undefined"}return"(unknown)"}(b,c)},string_format:function(b){return'"'+b.replace(/[\u0000-\u001f\u007f-\u009f\ufffe-\uffff]/g,function(c){c=c.charCodeAt(0);switch(c){case 0:c="\\0";break;case 8:c="\\b";break;
case 9:c="\\t";break;case 10:c="\\n";break;case 12:c="\\f";break;case 13:c="\\r";break;default:c="\\"+(c>=256?"u":"x")+(c<=16?"0":"")+c.toString(16).toUpperCase()}return c})+'"'},type_is_obvious:function(b){switch(typeof b){case "function":b=Object.prototype.toString.call(b);b=b.substring(8,b.length-1);if(b==="RegExp")break;case "undefined":return true;case "object":b=Object.prototype.toString.call(b);b=b.substring(8,b.length-1);switch(b){case "Date":case "Number":case "Boolean":case "String":return true}}return false},
generate:function(b,c,d){return JSON.stringify({data:{type:typeof b,console:d.console.data,obvioustype:this.type_is_obvious(b)},error:c?c.name+": "+c.message:null,result:this.pretty_print(b)})}},global=typeof GlobalObject!=="undefined"?GlobalObject:{};global.console={};global.console.data=[];global.console.log=function(){for(var b=0,c=arguments.length;b<c;b++)global.console.data.push(utils.pretty_print(arguments[b]))};global.print=global.console.log;global.alert=global.console.log;global.kirby=function(){return"<(n_n<) <(n_n)> (>n_n)>"};
exports.run=function(b){var c,d;try{c=b(global)}catch(a){if(typeof a.name!=="undefined"&&typeof a.message!=="undefined"){d=a;d.name=a.name}else d=typeof a==="string"&&a.match(/\brocks?\b/)?{name:"Error",message:"Haven't you ever been told to never throw rocks?"}:{name:"Uncaught value",message:utils.pretty_print(a)}}return utils.generate(c,d,global)};
exports.pretty_print = utils.pretty_print;
